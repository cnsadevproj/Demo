# 📗 다했니 Google Sheets 템플릿 사용 가이드

## 🚀 빠른 시작

### 1단계: Google Sheets 생성

1. 새 Google Sheets 만들기
2. 다음 시트들을 생성:

#### 📗 [설정] 시트
```
A1: 다했니 API 키
A2: {여기에 실제 API 키 입력}
A3:
A4: 학기 시작일
A5: 2024-09-01
A6:
A7: 현재 주차
A8: 1
```

#### 📘 [학급목록] 시트
```
A1: 학급명    B1: 학생수    C1: 마지막 업데이트
(Apps Script가 자동으로 채움)
```

---

### 2단계: Apps Script 설정

1. **확장 프로그램 → Apps Script** 클릭
2. `Code.gs` 파일에 `/home/user/Demo/apps-script/Code.gs` 내용 복사
3. **저장** (Ctrl+S)
4. 시트로 돌아가기

---

### 3단계: 초기 설정

1. **새로고침** (F5) → 메뉴에 **🎓 다했니** 나타남
2. **🎓 다했니 → ⚙️ 1. 클래스 목록 불러오기** 클릭
3. 자동으로 학급별 시트 생성됨:
   - `1-8_학생`
   - `1-8_팀`
   - `1-8_잔디`
   - `1-8_스냅샷`
   - (각 학급별 4개 시트)

---

### 4단계: 학생 코드 입력

1. 다했니 사이트에서 **학급별 학생 코드 CSV 다운로드**
2. 각 `{학급명}_학생` 시트 열기
3. **A2 셀부터 CSV 데이터 붙여넣기**:
   ```
   번호  이름    학생코드
   1     이다은  DAX96V5UG
   2     임우주  L2Q4ESMZ2
   ...
   ```

---

### 5단계: 학생 정보 동기화

1. **🎓 다했니 → 🔄 2. 학생 정보 동기화** 클릭
2. API를 통해 각 학생의 쿠키, 초코칩 등 자동 업데이트
3. 완료!

---

## 📅 주간 작업 루틴

### 월요일 오전
```
🎓 다했니 → 📸 3. 스냅샷 실행 → "예" (월요일)
→ B_mon 스냅샷 기록
```

### 수요일 오전
```
🎓 다했니 → 📸 3. 스냅샷 실행 → "아니오" (수요일)
→ B_wed 스냅샷 기록
→ earned_round 자동 계산
```

### 필요시
```
🎓 다했니 → 🔄 2. 학생 정보 동기화
→ 최신 쿠키 정보 업데이트
```

---

## 📊 시트 구조

### `{학급명}_학생`
| 번호 | 이름 | 학생코드 | 쿠키 | 사용쿠키 | 남은쿠키 | 초코칩 | 마지막 업데이트 |
|------|------|----------|------|----------|----------|--------|------------------|
| 1    | 이다은 | DAX96... | 1250 | 150      | 1100     | 50     | 2025-11-28...   |

- **번호, 이름, 학생코드**: 수동 입력 (CSV)
- **쿠키~마지막 업데이트**: API 자동 채움

### `{학급명}_팀`
| 주차 | 팀ID | 팀명 | 플래그 | 멤버 | 라운드쿠키 | 공격대상 | 베팅 | 방어 |
|------|------|------|--------|------|------------|----------|------|------|
| 12   | team1| 불꽃  | 🔥    | STU001,STU002 | 3200 | team2 | 1500 | 800 |

- **수동 관리** (앱에서 자동화 예정)

### `{학급명}_잔디`
| 날짜 | 학생코드 | 완료여부 | 미션타입 |
|------|----------|----------|----------|
| 2024-11-28 | DAX96V5UG | TRUE | personal |

- **수동 또는 앱 연동**

### `{학급명}_스냅샷`
| 주차 | 학생코드 | 팀ID | B_mon | B_wed | earned_round | 날짜 |
|------|----------|------|-------|-------|--------------|------|
| 12   | DAX96... | team1 | 1000 | 1250  | 250         | 2025-11-28... |

- **Apps Script 자동 기록**

---

## 🔧 트러블슈팅

### "API KEY 가 올바르지 않습니다"
→ [설정] 시트 A2 셀의 API 키 확인

### "학급목록이 비어있습니다"
→ 먼저 "1. 클래스 목록 불러오기" 실행

### 동기화가 느려요
→ Rate Limit 고려로 100ms 간격 (정상)
→ 학생 100명 기준 약 10초 소요

### 메뉴가 안 보여요
→ 페이지 새로고침 (F5)
→ Apps Script 저장 확인

---

## 📞 지원

- **GitHub**: https://github.com/cnsadevproj/Demo
- **Issues**: 문제 발생 시 이슈 등록

---

## 🎯 다음 단계

1. ✅ Google Sheets 템플릿 설정
2. ✅ Apps Script 설치
3. ✅ 학생 정보 동기화
4. 🔜 웹 앱에서 Sheets 데이터 읽기
5. 🔜 팀 배정, 잔디 기록 자동화
